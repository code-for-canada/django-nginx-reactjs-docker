#Travis Config File

services:
  - docker

language: node_js

warnings_are_errors: true

matrix:
  include:
    #Backend Tests
    - language: python
      python: 3.6
      provider: script
      before_script:
        - cd backend/
        - pip install -r requirements.txt
      script:
        - docker-compose run --rm backend ./manage.py test tests

    #APIs Tests
    - language: node_js
      node_js: 10.15
      provider: script
      install:
        - npm install newman
      before_script:
        - docker-compose up -d --build
        - npm install frontend/
        - node_modules/.bin/newman --version
        - cd backend/
        - pip install -r requirements.txt
        - python manage.py runserver
        - cd ..
      script:
        - node_modules/.bin/newman run backend/tests/ThunderCAT.postman_collection.json -e backend/tests/ThunderCAT.postman_environment.json

    #Frontend Tests
    - language: node_js
      node_js: 10.15
      provider: script
      before_script:
        - docker-compose up -d --build
        - npm install frontend/
      script:
        - docker-compose run --rm frontend npm test src/tests/ -- --coverage
